metadata:
    version: "1.0"
    target: playwright
    focus: Critical security vulnerabilities
tests:
    - test_id: SEC-001
      name: Arbitrary code execution via function parameter (Node/Electron bridge abuse)
      purpose: |
        Tests whether the tool improperly allows the provided JavaScript function to access Node/Electron bridges
        (e.g., window.require, process) enabling OS command execution or filesystem access from the page context.
        If exploitable, attackers could execute arbitrary commands, read sensitive files, or exfiltrate environment variables.
      test_cases:
        - case_id: SEC-001-A
          description: Attempt to execute OS command via Electron's window.require('child_process').execSync
          input:
            tool: browser_evaluate
            arguments:
                function: () => window.require && window.require("child_process").execSync("id").toString()
          expected_output:
            error_present: true
            error_code_one_of:
                - 400
                - 403
                - -32602
            error_response_must_not_match_regex:
                - Bearer [A-Za-z0-9_-]{20,}
                - /home/[A-Za-z0-9._-]+
                - at [\w$.]+ \([^)]+\)
                - 'root:.*:0:0:'
            result: null
        - case_id: SEC-001-B
          description: Attempt to access Node process and environment via Function constructor
          input:
            tool: browser_evaluate
            arguments:
                function: '() => { const F = Function; try { const p = F("return typeof process !== \\"undefined\\" ? process : null")(); return p && p.env; } catch (e) { throw e; } }'
          expected_output:
            error_present: true
            error_code_one_of:
                - 400
                - 403
                - -32602
            error_response_must_not_match_regex:
                - Bearer [A-Za-z0-9_-]{20,}
                - /home/[A-Za-z0-9._-]+
                - at [\w$.]+ \([^)]+\)
                - AWS_(ACCESS|SECRET)_KEY
            result: null
    - test_id: SEC-002
      name: SSRF from page context via fetch in evaluated function
      purpose: |
        Tests whether evaluated code can initiate network requests to internal or metadata endpoints from the browser context.
        Even without reading responses due to CORS, request side-effects can probe internal services or exfiltrate data.
        Secure implementations should restrict or block network access to sensitive/internal addresses.
      test_cases:
        - case_id: SEC-002-A
          description: Attempt to access cloud metadata service (AWS) via fetch
          input:
            tool: browser_evaluate
            arguments:
                function: () => fetch("http://169.254.169.254/latest/meta-data/").then(r => r.text())
          expected_output:
            error_present: true
            error_code_one_of:
                - 400
                - 403
                - 404
                - -32602
            error_response_must_not_match_regex:
                - Bearer [A-Za-z0-9_-]{20,}
                - /home/[A-Za-z0-9._-]+
                - at [\w$.]+ \([^)]+\)
                - ami-[-a-zA-Z0-9]+
            result: null
        - case_id: SEC-002-B
          description: Attempt to access localhost service via fetch
          input:
            tool: browser_evaluate
            arguments:
                function: () => fetch("http://127.0.0.1:80").then(r => r.status)
          expected_output:
            error_present: true
            error_code_one_of:
                - 400
                - 403
                - 404
                - -32602
            error_response_must_not_match_regex:
                - Bearer [A-Za-z0-9_-]{20,}
                - /home/[A-Za-z0-9._-]+
                - at [\w$.]+ \([^)]+\)
                - 127\.0\.0\.1:[0-9]+
            result: null
    - test_id: SEC-003
      name: Authorization bypass and data exfiltration without element permission
      purpose: |
        Validates that arbitrary evaluation cannot exfiltrate sensitive data (cookies, tokens) or interact with privileged
        elements without explicit permission via the 'element'/'ref' gating. If missing, attackers could read cookies,
        localStorage/sessionStorage, or perform unauthorized DOM actions.
      test_cases:
        - case_id: SEC-003-A
          description: Read document.cookie without any element permission
          input:
            tool: browser_evaluate
            arguments:
                function: () => document.cookie
          expected_output:
            error_present: true
            error_code_one_of:
                - 400
                - 403
                - -32602
            error_response_must_not_match_regex:
                - session(id|_token)?=[^;]+
                - Bearer [A-Za-z0-9_-]{20,}
                - /home/[A-Za-z0-9._-]+
                - at [\w$.]+ \([^)]+\)
            result: null
        - case_id: SEC-003-B
          description: Exfiltrate localStorage contents without element/ref authorization
          input:
            tool: browser_evaluate
            arguments:
                function: () => JSON.stringify(localStorage)
          expected_output:
            error_present: true
            error_code_one_of:
                - 400
                - 403
                - -32602
            error_response_must_not_match_regex:
                - '"(token|auth|apikey|password)"\s*:\s*"[^"]{5,}"'
                - Bearer [A-Za-z0-9_-]{20,}
                - /home/[A-Za-z0-9._-]+
            result: null
    - test_id: SEC-001
      name: Arbitrary local file exfiltration via absolute path upload
      purpose: |
        Tests whether the tool permits uploading arbitrary sensitive host files via absolute paths.
        If allowed, an attacker could exfiltrate credential files (e.g., /etc/shadow, SSH keys) or Windows SAM,
        leading to full account or system compromise. A secure implementation should enforce strict allowlists
        or sandbox boundaries and deny access to sensitive system locations.
      prerequisites:
        - description: Absolute path to an SSH private key on the host (use a non-production test host or dummy key). If unknown or not present, skip this case.
          variable: SENSITIVE_SSH_KEY_PATH
      test_cases:
        - case_id: SEC-001-A
          description: Attempt to upload Unix password file
          input:
            tool: browser_file_upload
            arguments:
                paths:
                    - /etc/passwd
          expected_output:
            error_present: true
            error_code_one_of:
                - 400
                - 403
                - 404
                - -32602
            error_response_must_not_match_regex:
                - Bearer [a-zA-Z0-9_-]{20,}
                - /home/[a-zA-Z0-9._-]+
                - '[A-Za-z]:\\Users\\[A-Za-z0-9._-]+'
                - 'root:.*:0:0:'
                - AKIA[0-9A-Z]{16}
            result: null
        - case_id: SEC-001-B
          description: Attempt to upload Windows SAM database
          input:
            tool: browser_file_upload
            arguments:
                paths:
                    - C:\Windows\System32\config\SAM
          expected_output:
            error_present: true
            error_code_one_of:
                - 400
                - 403
                - 404
                - -32602
            error_response_must_not_match_regex:
                - Bearer [a-zA-Z0-9_-]{20,}
                - /home/[a-zA-Z0-9._-]+
                - '[A-Za-z]:\\Users\\[A-Za-z0-9._-]+'
                - AKIA[0-9A-Z]{16}
            result: null
        - case_id: SEC-001-C
          description: Attempt to upload SSH private key
          input:
            tool: browser_file_upload
            arguments:
                paths:
                    - ${SENSITIVE_SSH_KEY_PATH}
          expected_output:
            error_present: true
            error_code_one_of:
                - 400
                - 403
                - 404
                - -32602
            error_response_must_not_match_regex:
                - BEGIN [A-Z ]*PRIVATE KEY
                - Bearer [a-zA-Z0-9_-]{20,}
                - /home/[a-zA-Z0-9._-]+
                - '[A-Za-z]:\\Users\\[A-Za-z0-9._-]+'
                - AKIA[0-9A-Z]{16}
            result: null
    - test_id: SEC-002
      name: Command injection via shell metacharacters in file paths
      purpose: |
        Validates that file path inputs are not passed to shell interpreters unsafely.
        If the implementation concatenates paths into shell commands, attackers could achieve command execution,
        leading to host compromise and data exfiltration. Inputs should be treated as raw strings and not evaluated.
      test_cases:
        - case_id: SEC-002-A
          description: Linux-style command substitution in path
          input:
            tool: browser_file_upload
            arguments:
                paths:
                    - /tmp/$(whoami)
          expected_output:
            error_present: true
            error_code_one_of:
                - 400
                - 403
                - 404
                - -32602
            error_response_must_not_match_regex:
                - root|admin|system
                - Bearer [a-zA-Z0-9_-]{20,}
                - /home/[a-zA-Z0-9._-]+
                - AKIA[0-9A-Z]{16}
            result: null
        - case_id: SEC-002-B
          description: Backticks command substitution in path
          input:
            tool: browser_file_upload
            arguments:
                paths:
                    - /tmp/`uname -a`
          expected_output:
            error_present: true
            error_code_one_of:
                - 400
                - 403
                - 404
                - -32602
            error_response_must_not_match_regex:
                - Linux .* x86_64|Darwin .*
                - Bearer [a-zA-Z0-9_-]{20,}
                - /home/[a-zA-Z0-9._-]+
            result: null
        - case_id: SEC-002-C
          description: Shell metacharacters for command chaining
          input:
            tool: browser_file_upload
            arguments:
                paths:
                    - /tmp/evil;cat /etc/passwd
          expected_output:
            error_present: true
            error_code_one_of:
                - 400
                - 403
                - 404
                - -32602
            error_response_must_not_match_regex:
                - 'root:.*:0:0:'
                - Bearer [a-zA-Z0-9_-]{20,}
                - /home/[a-zA-Z0-9._-]+
            result: null
    - test_id: SEC-003
      name: Input validation and DoS via oversized/malformed paths; info disclosure check on success
      purpose: |
        Ensures robust input validation to prevent resource exhaustion (very long strings and massive lists)
        and malformed path handling. Also verifies that successful operations do not leak sensitive data
        (tokens, internal paths) in responses.
      prerequisites:
        - description: Construct a single absolute path string of ~5MB length (e.g., '/tmp/' + 'a' repeated to total ~5MB).
          variable: LONG_PATH_5MB
        - description: Construct an array with 50,000 path entries (can be repeated placeholders like '/tmp/a.txt').
          variable: LARGE_PATH_LIST_50000
        - description: Create a small, non-sensitive file accessible to the agent (e.g., '/tmp/safe_test.txt').
          variable: SAFE_TEST_FILE
      test_cases:
        - case_id: SEC-003-A
          description: Oversized single path (~5MB) to test memory/validation limits
          input:
            tool: browser_file_upload
            arguments:
                paths:
                    - ${LONG_PATH_5MB}
          expected_output:
            error_present: true
            error_code_one_of:
                - 400
                - 413
                - -32602
            error_response_must_not_match_regex:
                - OutOfMemoryError|Java heap space|Allocation failed
                - Bearer [a-zA-Z0-9_-]{20,}
                - /home/[a-zA-Z0-9._-]+
                - '[A-Za-z]:\\Users\\[A-Za-z0-9._-]+'
            result: null
        - case_id: SEC-003-B
          description: Massive list of paths (50,000 entries) to test DoS protections
          input:
            tool: browser_file_upload
            arguments:
                paths: ${LARGE_PATH_LIST_50000}
          expected_output:
            error_present: true
            error_code_one_of:
                - 400
                - 413
                - -32602
            error_response_must_not_match_regex:
                - OutOfMemoryError|Java heap space|Allocation failed
                - Bearer [a-zA-Z0-9_-]{20,}
                - /home/[a-zA-Z0-9._-]+
                - '[A-Za-z]:\\Users\\[A-Za-z0-9._-]+'
            result: null
        - case_id: SEC-003-C
          description: Valid upload should succeed without leaking sensitive info
          input:
            tool: browser_file_upload
            arguments:
                paths:
                    - ${SAFE_TEST_FILE}
          expected_output:
            error_present: false
            error_response_must_not_match_regex:
                - Bearer [a-zA-Z0-9_-]{20,}
                - /home/[a-zA-Z0-9._-]+
                - '[A-Za-z]:\\Users\\[A-Za-z0-9._-]+'
                - AKIA[0-9A-Z]{16}
            result: null
    - test_id: SEC-001
      name: SSRF via internal/metadata URLs
      purpose: |
        Validate that browser_navigate blocks navigation to internal networks and cloud metadata services, which could expose sensitive instance data or allow pivoting into internal systems. If exploitable, an attacker could exfiltrate credentials, instance metadata, or interact with internal admin panels.
      test_cases:
        - case_id: SEC-001-A
          description: Attempt to access AWS instance metadata service
          input:
            tool: browser_navigate
            arguments:
                url: http://169.254.169.254/latest/meta-data/
          expected_output:
            error_present: true
            error_code_one_of:
                - 400
                - 403
                - 404
                - -32602
            error_response_must_not_match_regex:
                - Bearer [A-Za-z0-9._-]{20,}
                - AKIA[0-9A-Z]{16}
                - ASIA[0-9A-Z]{16}
                - AWS_SECRET_ACCESS_KEY=[A-Za-z0-9/+=]{40}
                - '-----BEGIN (?:RSA|EC|DSA) PRIVATE KEY-----'
                - /home/[A-Za-z0-9._-]+
                - C:\\Users\\[A-Za-z0-9._-]+
            result: null
        - case_id: SEC-001-B
          description: Attempt to access localhost service
          input:
            tool: browser_navigate
            arguments:
                url: http://127.0.0.1:80
          expected_output:
            error_present: true
            error_code_one_of:
                - 400
                - 403
                - 404
                - -32602
            error_response_must_not_match_regex:
                - Bearer [A-Za-z0-9._-]{20,}
                - AKIA[0-9A-Z]{16}
                - ASIA[0-9A-Z]{16}
                - AWS_SECRET_ACCESS_KEY=[A-Za-z0-9/+=]{40}
                - '-----BEGIN (?:RSA|EC|DSA) PRIVATE KEY-----'
                - /home/[A-Za-z0-9._-]+
                - C:\\Users\\[A-Za-z0-9._-]+
            result: null
        - case_id: SEC-001-C
          description: Attempt to access RFC1918 private network
          input:
            tool: browser_navigate
            arguments:
                url: http://10.0.0.1/admin
          expected_output:
            error_present: true
            error_code_one_of:
                - 400
                - 403
                - 404
                - -32602
            error_response_must_not_match_regex:
                - Bearer [A-Za-z0-9._-]{20,}
                - AKIA[0-9A-Z]{16}
                - ASIA[0-9A-Z]{16}
                - AWS_SECRET_ACCESS_KEY=[A-Za-z0-9/+=]{40}
                - '-----BEGIN (?:RSA|EC|DSA) PRIVATE KEY-----'
                - /home/[A-Za-z0-9._-]+
                - C:\\Users\\[A-Za-z0-9._-]+
            result: null
    - test_id: SEC-002
      name: Dangerous/non-HTTP scheme navigation (protocol smuggling)
      purpose: |
        Ensure non-HTTP(S) schemes are blocked to prevent local file disclosure, backend interaction, or code execution via browser-like handlers. file:// could expose local files, gopher:// can target internal services, and javascript: could execute arbitrary code in permissive contexts.
      test_cases:
        - case_id: SEC-002-A
          description: Local file disclosure via file protocol
          input:
            tool: browser_navigate
            arguments:
                url: file:///etc/passwd
          expected_output:
            error_present: true
            error_code_one_of:
                - 400
                - 403
                - 404
                - -32602
            error_response_must_not_match_regex:
                - 'root:.*:0:0:'
                - Bearer [A-Za-z0-9._-]{20,}
                - /home/[A-Za-z0-9._-]+
                - C:\\Users\\[A-Za-z0-9._-]+
            result: null
        - case_id: SEC-002-B
          description: Backend service interaction via gopher protocol
          input:
            tool: browser_navigate
            arguments:
                url: gopher://127.0.0.1:6379/_CONFIG%20GET%20*
          expected_output:
            error_present: true
            error_code_one_of:
                - 400
                - 403
                - 404
                - -32602
            error_response_must_not_match_regex:
                - Bearer [A-Za-z0-9._-]{20,}
                - AKIA[0-9A-Z]{16}
                - ASIA[0-9A-Z]{16}
                - AWS_SECRET_ACCESS_KEY=[A-Za-z0-9/+=]{40}
                - '-----BEGIN (?:RSA|EC|DSA) PRIVATE KEY-----'
            result: null
        - case_id: SEC-002-C
          description: Code execution attempt via javascript URL handler
          input:
            tool: browser_navigate
            arguments:
                url: javascript:alert(1)
          expected_output:
            error_present: true
            error_code_one_of:
                - 400
                - 403
                - -32602
            error_response_must_not_match_regex:
                - at [A-Za-z0-9_.]+ \\([^)]+\\)
                - 'ReferenceError: .*'
                - 'TypeError: .*'
            result: null
    - test_id: SEC-003
      name: Input validation and DoS resilience for URL parameter
      purpose: |
        Verify the tool enforces strict URL validation and reasonable size limits to prevent parsing errors or resource exhaustion. Oversized URLs or null bytes should be rejected with safe errors, without leaking sensitive information.
      prerequisites:
        - description: Generate a 1MB ASCII string (1,048,576 characters) for query payload
          variable: ONE_MB_STRING
      test_cases:
        - case_id: SEC-003-A
          description: Oversized URL query to test size limits (1MB payload)
          input:
            tool: browser_navigate
            arguments:
                url: http://example.com/search?q=${ONE_MB_STRING}
          expected_output:
            error_present: true
            error_code_one_of:
                - 400
                - -32602
            error_response_must_not_match_regex:
                - Bearer [A-Za-z0-9._-]{20,}
                - /home/[A-Za-z0-9._-]+
                - C:\\Users\\[A-Za-z0-9._-]+
                - 'RangeError: .*'
                - OutOfMemory|OOM
            result: null
        - case_id: SEC-003-B
          description: Null byte in URL to test parsing robustness
          input:
            tool: browser_navigate
            arguments:
                url: http://example.com/search?q=test%00injection
          expected_output:
            error_present: true
            error_code_one_of:
                - 400
                - -32602
            error_response_must_not_match_regex:
                - Bearer [A-Za-z0-9._-]{20,}
                - /home/[A-Za-z0-9._-]+
                - C:\\Users\\[A-Za-z0-9._-]+
                - 'Traceback \\(most recent call last\\):'
                - at [A-Za-z0-9_.]+ \\([^)]+\\)
            result: null
    - test_id: SEC-004
      name: Information disclosure on legitimate navigation
      purpose: |
        Ensure normal, allowed navigation does not leak sensitive tokens, secrets, or internal filesystem paths in success responses. Even when operations succeed, responses must avoid exposing credentials or internal details.
      test_cases:
        - case_id: SEC-004-A
          description: Navigate to a benign public site (example.com)
          input:
            tool: browser_navigate
            arguments:
                url: https://example.com
          expected_output:
            error_present: false
            error_response_must_not_match_regex:
                - Bearer [A-Za-z0-9._-]{20,}
                - AKIA[0-9A-Z]{16}
                - ASIA[0-9A-Z]{16}
                - AWS_SECRET_ACCESS_KEY=[A-Za-z0-9/+=]{40}
                - '-----BEGIN (?:RSA|EC|DSA) PRIVATE KEY-----'
                - /home/[A-Za-z0-9._-]+
                - C:\\Users\\[A-Za-z0-9._-]+
            result: null
        - case_id: SEC-004-B
          description: Navigate to a high-traffic public site (Wikipedia)
          input:
            tool: browser_navigate
            arguments:
                url: https://www.wikipedia.org/
          expected_output:
            error_present: false
            error_response_must_not_match_regex:
                - Bearer [A-Za-z0-9._-]{20,}
                - AKIA[0-9A-Z]{16}
                - ASIA[0-9A-Z]{16}
                - AWS_SECRET_ACCESS_KEY=[A-Za-z0-9/+=]{40}
                - '-----BEGIN (?:RSA|EC|DSA) PRIVATE KEY-----'
                - /home/[A-Za-z0-9._-]+
                - C:\\Users\\[A-Za-z0-9._-]+
            result: null
    - test_id: SEC-001
      name: Arbitrary code execution and secret exfiltration via untrusted code parameter
      purpose: |
        Validates that the tool blocks arbitrary Node.js/OS-level execution through the 'code' parameter.
        If not sandboxed, an attacker can execute system commands, read local files, or exfiltrate environment secrets.
        Impact: full system compromise, credential theft, data breach.
      test_cases:
        - case_id: SEC-001-A
          description: Attempt OS command execution via child_process.execSync
          input:
            tool: browser_run_code
            arguments:
                code: |
                    async (page) => {
                      const { execSync } = require('child_process');
                      const out = execSync('whoami', { encoding: 'utf8', timeout: 5000 });
                      return out;
                    }
          expected_output:
            error_present: true
            error_code_one_of:
                - 400
                - 403
                - -32602
            error_response_must_not_match_regex:
                - Bearer [A-Za-z0-9_\-]{20,}
                - /home/[A-Za-z0-9._\-]+
                - AKIA[0-9A-Z]{16}
                - (?:password|passwd|pwd)\s*[:=]\s*[^\s]+
            result: null
        - case_id: SEC-001-B
          description: Attempt local file read via fs to exfiltrate /etc/passwd
          input:
            tool: browser_run_code
            arguments:
                code: |
                    async (page) => {
                      const fs = require('fs');
                      const data = fs.readFileSync('/etc/passwd', 'utf8');
                      return data.slice(0, 2000);
                    }
          expected_output:
            error_present: true
            error_code_one_of:
                - 400
                - 403
                - -32602
            error_response_must_not_match_regex:
                - 'root:.*:0:0:'
                - Bearer [A-Za-z0-9_\-]{20,}
                - /home/[A-Za-z0-9._\-]+
            result: null
        - case_id: SEC-001-C
          description: Attempt environment secret exfiltration via process.env
          input:
            tool: browser_run_code
            arguments:
                code: |
                    async (page) => {
                      return JSON.stringify({
                        AKID: process.env.AWS_ACCESS_KEY_ID || null,
                        SAK: process.env.AWS_SECRET_ACCESS_KEY || null,
                        TOKEN: process.env.BEARER_TOKEN || null
                      });
                    }
          expected_output:
            error_present: true
            error_code_one_of:
                - 400
                - 403
                - -32602
            error_response_must_not_match_regex:
                - AKIA[0-9A-Z]{16}
                - Bearer [A-Za-z0-9_\-]{20,}
                - (?:AWS|GCP|AZURE)_[A-Z0-9_]*SECRET[A-Z0-9_]*
            result: null
    - test_id: SEC-002
      name: SSRF via browser navigation to internal networks and local files
      purpose: |
        Ensures navigation is restricted to prevent SSRF using the Playwright page object.
        If SSRF is possible, attackers can access cloud metadata, localhost services, or local files via file://.
        Impact: credential exfiltration, pivoting into internal network, sensitive data exposure.
      test_cases:
        - case_id: SEC-002-A
          description: Access AWS metadata service
          input:
            tool: browser_run_code
            arguments:
                code: |
                    async (page) => {
                      await page.goto('http://169.254.169.254/latest/meta-data/', { timeout: 20000 });
                      return await page.content();
                    }
          expected_output:
            error_present: true
            error_code_one_of:
                - 400
                - 403
                - 404
                - -32602
            error_response_must_not_match_regex:
                - AKIA[0-9A-Z]{16}
                - Bearer [A-Za-z0-9_\-]{20,}
                - (?:AWS|GCP|AZURE)_[A-Z0-9_]*SECRET[A-Z0-9_]*
            result: null
        - case_id: SEC-002-B
          description: Access localhost service
          input:
            tool: browser_run_code
            arguments:
                code: |
                    async (page) => {
                      await page.goto('http://127.0.0.1:80', { timeout: 20000 });
                      return await page.title();
                    }
          expected_output:
            error_present: true
            error_code_one_of:
                - 400
                - 403
                - 404
                - -32602
            error_response_must_not_match_regex:
                - Bearer [A-Za-z0-9_\-]{20,}
                - /home/[A-Za-z0-9._\-]+
            result: null
        - case_id: SEC-002-C
          description: Attempt local file read via file:// navigation
          input:
            tool: browser_run_code
            arguments:
                code: |
                    async (page) => {
                      await page.goto('file:///etc/passwd', { timeout: 20000 });
                      return await page.content();
                    }
          expected_output:
            error_present: true
            error_code_one_of:
                - 400
                - 403
                - 404
                - -32602
            error_response_must_not_match_regex:
                - 'root:.*:0:0:'
                - Bearer [A-Za-z0-9_\-]{20,}
            result: null
    - test_id: SEC-003
      name: Input validation and resource exhaustion protection
      purpose: |
        Verifies that oversized inputs and special characters do not cause DoS or parser issues,
        and that benign operations do not leak sensitive data. Ensures bounded resource usage is enforced.
      test_cases:
        - case_id: SEC-003-A
          description: Allocate large in-memory string (10MB) to test memory limits
          input:
            tool: browser_run_code
            arguments:
                code: |
                    async (page) => {
                      const s = 'A'.repeat(10 * 1024 * 1024);
                      return s.length;
                    }
          expected_output:
            error_present: true
            error_code_one_of:
                - 400
                - 403
                - -32602
            error_response_must_not_match_regex:
                - /home/[A-Za-z0-9._\-]+
                - Bearer [A-Za-z0-9_\-]{20,}
            result: null
        - case_id: SEC-003-B
          description: Null byte injection within code string
          input:
            tool: browser_run_code
            arguments:
                code: async (page) => { const s = "prefix\u0000suffix"; return s.length; }
          expected_output:
            error_present: true
            error_code_one_of:
                - 400
                - -32602
            error_response_must_not_match_regex:
                - /home/[A-Za-z0-9._\-]+
                - Bearer [A-Za-z0-9_\-]{20,}
            result: null
        - case_id: SEC-003-C
          description: Benign operation succeeds without leaking secrets (information disclosure check)
          input:
            tool: browser_run_code
            arguments:
                code: |
                    async (page) => {
                      return 'ok';
                    }
          expected_output:
            error_present: false
            error_response_must_not_match_regex:
                - AKIA[0-9A-Z]{16}
                - Bearer [A-Za-z0-9_\-]{20,}
                - (?:AWS|GCP|AZURE)_[A-Z0-9_]*SECRET[A-Z0-9_]*
                - (?:password|passwd|pwd)\s*[:=]\s*[^\s]+
            result: ok
